window.mdEdit=function(l){function r(a,b,c,d){return a.slice(0,b)+(d||"")+a.slice(b+(+c||0))}function p(a){this.f=a}function t(a,b){if(!a)return null;var c=0,d=a;do{var e=d;if(d=d.firstChild){do{var m=d.textContent.length;if(c<=b&&c+m>b)break;c+=m}while(d=d.nextSibling)}if(!d)break}while(d&&d.hasChildNodes()&&3!=d.nodeType);if(d)return{element:d,offset:b-c};if(e){for(d=e;d&&d.lastChild;)d=d.lastChild;return 3===d.nodeType?{element:d,offset:d.textContent.length}:{element:d,offset:0}}return{element:a,
offset:0,error:!0}}function h(a){this.o=a;this.j=[];this.n=[]}function f(a,b){if(!(this instanceof f))return new f(a,b);b=b||{};"PRE"===a.tagName?this.a=a:(this.a=document.createElement("pre"),a.appendChild(this.a));var c=b.className||"";this.a.className="mdedit"+(c?" "+c:"");this.a.setAttribute("contenteditable",!0);this.b=new p(a);this.i=new h(this);k.bind(a,"cut",this.w.bind(this));k.bind(a,"paste",this.G.bind(this));k.bind(a,"keyup",this.D.bind(this));k.bind(a,"input",this.g.bind(this));k.bind(a,
"keydown",this.B.bind(this));k.bind(a,"keypress",this.C.bind(this));this.t=b.change||function(){};this.g()}var u=function(){function a(a,b){e[a]=d[a]=c[a]=b}function b(a,b){e[a]=c[a]=b}var c={comment:l.languages.markup.comment},d={},e={},m={markup:["markup","html","xml"],javascript:["javascript","js"]},g;for(g in l.languages)if(l.languages.hasOwnProperty(g)){var f=l.languages[g];if("function"!==typeof f){var q=m[g];b("code-block fenced "+g,{pattern:new RegExp("(^ {0,3}|\\n {0,3})(([`~])\\3\\3) *("+
(q?q.join("|"):g)+")( [^`\n]*)? *\\n(?:[\\s\\S]*?)\\n {0,3}(\\2\\3*(?= *\\n)|$)","gi"),lookbehind:!0,inside:{"code-language":{pattern:/(^([`~])\2+)((?!\2)[^\2\n])+/,lookbehind:!0},"marker code-fence start":/^([`~])\1+/,"marker code-fence end":/([`~])\1+$/,"code-inner":{pattern:/(^\n)[\s\S]*(?=\n$)/,lookbehind:!0,alias:"language-"+g,inside:f}}})}}b("code-block fenced untagged",{pattern:/(^ {0,3}|\n {0,3})(([`~])\3\3)[^`\n]*\n(?:[\s\S]*?)\n {0,3}(\2\3*(?= *\n)|$)/g,lookbehind:!0,inside:{"code-language":{pattern:/(^([`~])\2+)((?!\2)[^\2\n])+/,
lookbehind:!0},"marker code-fence start":/^([`~])\1+/,"marker code-fence end":/([`~])\1+$/,"code-inner":{pattern:/(^\n)[\s\S]*(?=\n$)/,lookbehind:!0}}});b("heading setext-heading heading-1",{pattern:/^ {0,3}[^\s].*\n {0,3}=+[ \t]*$/gm,inside:{"marker heading-setext-line":{pattern:/^( {0,3}[^\s].*\n) {0,3}=+[ \t]*$/gm,lookbehind:!0},rest:d}});b("heading setext-heading heading-2",{pattern:/^ {0,3}[^\s].*\n {0,3}-+[ \t]*$/gm,inside:{"marker heading-setext-line":{pattern:/^( {0,3}[^\s].*\n) {0,3}-+[ \t]*$/gm,
lookbehind:!0},rest:d}});m={"marker heading-hash start":/^ *#+ */,"marker heading-hash end":/ +#+ *$/,rest:d};for(g=1;6>=g;g+=1)b("heading heading-"+g,{pattern:new RegExp("^ {0,3}#{"+g+"}(?!#).*$","gm"),inside:m});g={pattern:/^\[(?:\\.|[^\[\]]|\[[^\[\]]*\])*\]/,inside:{"marker bracket start":/^\[/,"marker bracket end":/\]$/,"link-text-inner":{pattern:/[\w\W]+/,inside:d}}};var m={pattern:/\[(?:\\.|[^\]])*\]/,inside:{"marker bracket start":/^\[/,"marker bracket end":/\]$/,"link-label-inner":/[\w\W]+/}},
f={pattern:/^!\[(?:\\.|[^\[\]]|\[[^\[\]]*\])*\]/,inside:{"marker image-bang":/^!/,"marker bracket start":/^\[/,"marker bracket end":/\]$/,"image-text-inner":{pattern:/[\w\W]+/,inside:d}}},q={pattern:/^(\s*)(?!<)(?:\\.|[^\(\)\s]|\([^\(\)\s]*\))+/,lookbehind:!0},n={pattern:/^(\s*)<(?:\\.|[^<>\n])*>/,lookbehind:!0,inside:{"marker brace start":/^</,"marker brace end":/>$/,"braced-href-inner":/[\w\W]+/}},h={pattern:/('(?:\\'|[^'])+'|"(?:\\"|[^"])+")\s*$/,inside:{"marker quote start":/^['"]/,"marker quote end":/['"]$/,
"title-inner":/[\w\W]+/}},k={pattern:/\( *(?:(?!<)(?:\\.|[^\(\)\s]|\([^\(\)\s]*\))*|<(?:[^<>\n]|\\.)*>)( +('(?:[^']|\\')+'|"(?:[^"]|\\")+"))? *\)/,inside:{"marker bracket start":/^\(/,"marker bracket end":/\)$/,"link-params-inner":{pattern:/[\w\W]+/,inside:{"link-title":h,href:q,"braced-href":n}}}};b("hr",{pattern:/^[\t ]*([*\-_])([\t ]*\1){2,}([\t ]*$)/gm,inside:{"marker hr-marker":/[*\-_]/g}});b("urldef",{pattern:/^( {0,3})\[(?:\\.|[^\]])+]: *\n? *(?:(?!<)(?:\\.|[^\(\)\s]|\([^\(\)\s]*\))*|<(?:[^<>\n]|\\.)*>)( *\n? *('(?:\\'|[^'])+'|"(?:\\"|[^"])+"))?$/gm,
lookbehind:!0,inside:{"link-label":m,"marker urldef-colon":/^:/,"link-title":h,href:q,"braced-href":n}});b("blockquote",{pattern:/^[\t ]*>[\t ]?.+(?:\n(?!\n)|.)*/gm,inside:{"marker quote-marker":/^[\t ]*>[\t ]?/gm,"blockquote-content":{pattern:/[^>]+/,rest:e}}});b("list",{pattern:/^[\t ]*([*+\-]|\d+\.)[\t ].+(?:\n(?!\n)|.)*/gm,inside:{li:{pattern:/^[\t ]*([*+\-]|\d+\.)[\t ].+(?:\n|[ \t]+[^*+\- \t].*\n)*/gm,inside:{"marker list-item":/^[ \t]*([*+\-]|\d+\.)[ \t]/m,rest:e}}}});b("code-block indented",
{pattern:/(^|(?:^|(?:^|\n)(?![ \t]*([*+\-]|\d+\.)[ \t]).*\n)\s*?\n)((?: {4}|\t).*(?:\n|$))+/g,lookbehind:!0});b("p",{pattern:/[^\n](?:\n(?!\n)|.)*[^\n]/g,inside:d});a("image",{pattern:/(^|[^\\])!\[(?:\\.|[^\[\]]|\[[^\[\]]*\])*\]\(\s*(?:(?!<)(?:\\.|[^\(\)\s]|\([^\(\)\s]*\))*|<(?:[^<>\n]|\\.)*>)(\s+('(?:[^']|\\')+'|"(?:[^"]|\\")+"))?\s*\)/,lookbehind:!0,inside:{"link-text":f,"link-params":k}});a("link",{pattern:/(^|[^\\])\[(?:\\.|[^\[\]]|\[[^\[\]]*\])*\]\(\s*(?:(?!<)(?:\\.|[^\(\)\s]|\([^\(\)\s]*\))*|<(?:[^<>\n]|\\.)*>)(\s+('(?:[^']|\\')+'|"(?:[^"]|\\")+"))?\s*\)/,
lookbehind:!0,inside:{"link-text":g,"link-params":k}});a("image image-ref",{pattern:/(^|[^\\])!\[(?:\\.|[^\[\]]|\[[^\[\]]*\])*\] ?\[(?:\\.|[^\]])*\]/,lookbehind:!0,inside:{"link-text":f,"link-label":m}});a("link link-ref",{pattern:/(^|[^\\])\[(?:\\.|[^\[\]]|\[[^\[\]]*\])*\] ?\[(?:\\.|[^\]])*\]/,lookbehind:!0,inside:{"link-text":g,"link-label":m}});a("image image-ref shortcut-ref",{pattern:/(^|[^\\])!\[(?:\\.|[^\[\]]|\[[^\[\]]*\])*\]/,lookbehind:!0,inside:{"marker image-bang":/^!/,"link-text":g}});
a("link link-ref shortcut-ref",{pattern:/(^|[^\\])\[(?:\\.|[^\[\]]|\[[^\[\]]*\])*\]/,lookbehind:!0,inside:{"link-text":g}});a("code",{pattern:/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/g,lookbehind:!0,inside:{"marker code-marker start":/^`/,"marker code-marker end":/`$/,"code-inner":/[\w\W]+/}});a("strong",{pattern:/(^|[^\\*_]|\\[*_])([_\*])\2(?:\n(?!\n)|.)+?\2{2}(?!\2)/g,lookbehind:!0,inside:{"marker strong-marker start":/^(\*\*|__)/,"marker strong-marker end":/(\*\*|__)$/,"strong-inner":{pattern:/[\w\W]+/,
inside:d}}});a("em",{pattern:/(^|[^\\*_]|\\[*_])(\*|_)(?:\n(?!\n)|.)+?\2(?!\2)/g,lookbehind:!0,inside:{"marker em-marker start":/^(\*|_)/,"marker em-marker end":/(\*|_)$/,"em-inner":{pattern:/[\w\W]+/,inside:d}}});a("strike",{pattern:/(^|\n|(?!\\)\W)(~~)(?=\S)([^\r]*?\S)\2/gm,lookbehind:!0,inside:{"marker strike-marker start":/^~~/,"marker strike-marker end":/~~$/,"strike-inner":{pattern:/[\w\W]+/,inside:d}}});a("comment",l.languages.markup.comment);g=l.languages.markup.tag;a("tag",{pattern:new RegExp("(^|[^\\\\])"+
g.pattern.source,"i"),lookbehind:!0,inside:g.inside});a("entity",l.languages.markup.entity);return c}(),k={bind:function(a,b,c){a.addEventListener(b,c,!1)}},v={newline:function(a){var b=a.start,c=a.d.slice(a.d.lastIndexOf("\n")+1),d=c.match(/^\s*/)[0],e="";/^ {0,3}$/.test(d)&&(c=c.slice(d.length),/^[*+\-]\s+/.test(c)?e+=c.match(/^[*+\-]\s+/)[0]:/^\d+\.\s+/.test(c)?e+=c.match(/^\d+\.\s+/)[0].replace(/^\d+/,function(a){return+a+1}):/^>/.test(c)&&(e+=c.match(/^>\s*/)[0]));d+=e;a.d+="\n"+d;e=a.e;a.e=
"";a.start+=1+d.length;a.end=a.start;return{add:"\n"+d,c:e,start:b}},indent:function(a,b){var c=a.d.lastIndexOf("\n")+1;if(b.inverse)/\s/.test(a.d.charAt(c))&&(a.d=r(a.d,c,1),--a.start),a.e=a.e.replace(/\r?\n(?!\r?\n)\s/,"\n");else if(a.e||b.v)a.d=r(a.d,c,0,"\t"),a.e=a.e.replace(/\r?\n/,"\n\t"),a.start+=1;else return a.d+="\t",a.start+=1,a.end+=1,{add:"\t",c:"",start:a.start-1};a.end=a.start+a.e.length;return{action:"indent",start:a.start,end:a.end,inverse:b.inverse}}};p.prototype.h=function(){var a=
getSelection();if(!a.rangeCount)return 0;var b=a.getRangeAt(0),c=a=b.startContainer,b=b.startOffset;if(!(this.f.compareDocumentPosition(a)&16))return 0;do{for(;a=a.previousSibling;)a.textContent&&(b+=a.textContent.length);a=c=c.parentNode}while(a&&a!==this.f);return b};p.prototype.k=function(){var a=getSelection();return a.rangeCount?this.h()+String(a.getRangeAt(0)).length:0};p.prototype.l=function(a,b,c){var d=document.createRange(),e=t(this.f,a),f=e;b&&b!==a&&(f=t(this.f,b));if(!1!==c){a=f.element;
var g=f.offset;b=a.textContent;c=a.parentNode;var h=b.slice(0,g);a.textContent=b.slice(g);g=document.createTextNode(h);c.insertBefore(n,a);c.insertBefore(g,n);var h=n.offsetTop,k=n.offsetHeight,l=this.f.offsetHeight,p=this.f.scrollTop;a.textContent=b;c.removeChild(n);c.removeChild(g);0>h-p?this.f.scrollTop=h:h-p+k>l&&(this.f.scrollTop=h+k-l)}d.setStart(e.element,e.offset);d.setEnd(f.element,f.offset);e=getSelection();e.removeAllRanges();e.addRange(d)};var n=document.createElement("span");n.style.position=
"absolute";n.innerHTML="|";h.prototype.action=function(a){this.j.length&&this.s(this.j[this.j.length-1],a)?this.j.push(this.u(this.j.pop(),a)):this.j.push(a);this.n=[]};h.prototype.s=function(a,b){return!a.action&&!b.action&&!Array.isArray(a)&&!Array.isArray(b)&&!(a.c&&b.add)&&!(a.add&&b.c)&&!(a.add&&!b.add)&&!(!a.add&&b.add)&&!(a.add&&a.c)&&!(b.add&&b.c)&&a.start+a.add.length===b.start+b.c.length};h.prototype.u=function(a,b){return{add:a.add+b.add,c:b.c+a.c,start:Math.min(a.start,b.start)}};h.prototype.H=
function(){if(this.n.length){var a=this.n.pop();this.j.push(a);this.apply(a)}};h.prototype.apply=function b(c){Array.isArray(c)?c.forEach(b.bind(this)):c.action?this.o.action(c.action,{inverse:c.inverse,start:c.start,end:c.end,F:!0}):this.o.apply(c)};f.prototype.A=function(){var b=this.a.textContent;this.q!==b&&(this.t(b),this.q=b)};f.prototype.setValue=function(b){this.a.textContent=b;this.g()};f.prototype.getValue=function(){return this.a.textContent};f.prototype.D=function(b){b=b&&b.keyCode||0;
-1<[9,91,93,16,17,18,20,13,112,113,114,115,116,117,118,119,120,121,122,123,27].indexOf(b)||-1===[37,39,38,40].indexOf(b)&&this.g()};f.prototype.g=function(){var b=this.a.textContent,c=this.b.h(),d=this.b.k();this.p();this.a.innerHTML=l.highlight(b,u);this.I();null===c&&null===d||this.b.l(c,d);this.A()};f.prototype.p=function(){void 0===this.m&&(this.m=this.a.scrollTop);setTimeout(function(){this.m=void 0}.bind(this),500)};f.prototype.I=function(){this.a.scrollTop=this.m;this.m=void 0};f.prototype.C=
function(b){if(!b.metaKey&&!b.ctrlKey&&(b=b.charCode)){var c=this.b.h(),d=this.b.k();this.i.action({add:String.fromCharCode(b),c:c===d?"":this.a.textContent.slice(c,d),start:c})}};f.prototype.B=function(b){var c=b.metaKey||b.ctrlKey;switch(b.keyCode){case 8:case 46:var c=this.b.h(),d=this.b.k(),e=c===d?1:Math.abs(d-c),c=8===b.keyCode?d-e:c;this.i.action({add:"",c:this.a.textContent.slice(c,c+e),start:c});break;case 9:c||(this.action("indent",{inverse:b.shiftKey}),b.preventDefault());break;case 219:case 221:c&&
!b.shiftKey&&(this.action("indent",{inverse:219===b.keyCode,v:!0}),b.preventDefault());break;case 13:this.action("newline");b.preventDefault();break;case 89:c&&(this.i.H(),b.preventDefault());break;case 90:c&&(this.i[b.shiftKey?"redo":"undo"](),b.preventDefault())}};f.prototype.apply=function(b){var c=this.a;c.textContent=r(c.textContent,b.start,b.c.length,b.add);this.b.l(b.start,b.start+b.add.length);this.g()};f.prototype.action=function(b,c){c=c||{};var d=this.a.textContent,e=c.start||this.b.h(),
f=c.end||this.b.k(),d={start:e,end:f,d:d.slice(0,e),r:d.slice(f),e:d.slice(e,f)},e=v[b](d,c);this.p();this.a.textContent=d.d+d.e+d.r;e&&!c.F&&this.i.action(e);this.b.l(d.start,d.end,!1);this.g()};f.prototype.w=function(){var b=this.b.h(),c=this.b.k();b!==c&&this.i.action({add:"",c:this.a.textContent.slice(b,c),start:b})};f.prototype.G=function(b){var c=this.b.h(),d=this.b.k(),d=c===d?"":this.a.textContent.slice(c,d);b.clipboardData&&(b.preventDefault(),b=b.clipboardData.getData("text/plain"),document.execCommand("insertText",
!1,b),this.i.action({add:b,c:d,start:c}),c+=b.length,this.b.l(c,c),this.g())};return f}(window.Prism);
